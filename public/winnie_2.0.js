var app=function(e){"use strict";function t(){}function n(e,t){for(var n in t)e[n]=t[n];return e}function i(e,t){for(var n in t)e[n]=1;return e}function s(e,t){return 0===t&&e(),function(){--t||e()}}function r(e){e()}function o(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n)}function l(e){e.parentNode.removeChild(e)}function c(e,t){for(var n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function d(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function h(){return document.createComment("")}function f(e,t,n,i){e.addEventListener(t,n,i)}function p(e,t,n,i){e.removeEventListener(t,n,i)}function m(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function v(e,t){e.data=""+t}function g(e,t,n){e.style.setProperty(t,n)}function _(){return Object.create(null)}function y(e){e._lock=!0,k(e._beforecreate),k(e._oncreate),k(e._aftercreate),e._lock=!1}function b(e,t){e._handlers=_(),e._slots=_(),e._bind=t._bind,e._staged={},e.options=t,e.root=t.root||e,e.store=t.store||e.root.store,t.root||(e._beforecreate=[],e._oncreate=[],e._aftercreate=[])}function k(e){for(;e&&e.length;)e.shift()()}e=e&&e.hasOwnProperty("default")?e.default:e;var w={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(e,t){var n=e in this._handlers&&this._handlers[e].slice();if(n)for(var i=0;i<n.length;i+=1){var s=n[i];if(!s.__calling)try{s.__calling=!0,s.call(this,t)}finally{s.__calling=!1}}},on:function(e,t){var n=this._handlers[e]||(this._handlers[e]=[]);return n.push(t),{cancel:function(){var e=n.indexOf(t);~e&&n.splice(e,1)}}},set:function(e){this._set(n({},e)),this.root._lock||y(this.root)},_recompute:t,_set:function(e){var t=this._state,i={},s=!1;for(var r in e=n(this._staged,e),this._staged={},e)this._differs(e[r],t[r])&&(i[r]=s=!0);s&&(this._state=n(n({},t),e),this._recompute(i,this._state),this._bind&&this._bind(i,this._state),this._fragment&&(this.fire("state",{changed:i,current:this._state,previous:t}),this._fragment.p(i,this._state),this.fire("update",{changed:i,current:this._state,previous:t})))},_stage:function(e){n(this._staged,e)},_mount:function(e,t){this._fragment[this._fragment.i?"i":"m"](e,t||null)},_differs:function(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}};function T(e){e.changed,e.current,e.previous}function x(e,t){var n,i;return{c:function(){(n=d("span")).className=i=t.type+" legendIconStyle  svelte-1vhs5pf",g(n,"background-color",t.backgroundColor),g(n,"border-color",t.borderColor)},m:function(e,t){a(e,n,t)},p:function(e,t){e.type&&i!==(i=t.type+" legendIconStyle  svelte-1vhs5pf")&&(n.className=i),e.backgroundColor&&g(n,"background-color",t.backgroundColor),e.borderColor&&g(n,"border-color",t.borderColor)},d:function(e){e&&l(n)}}}function N(e,t){var n,i;return{c:function(){(n=d("img")).src=i=t.item.RenderStyle.iconUrl,m(n,"crossorigin",""),n.alt="Style Icon",n.className="svelte-1vhs5pf"},m:function(e,t){a(e,n,t)},p:function(e,t){e.item&&i!==(i=t.item.RenderStyle.iconUrl)&&(n.src=i)},d:function(e){e&&l(n)}}}function C(e){var t=this;b(this,e),this._state=n({},e.data),this._recompute({item:1},this._state),this._intro=!!e.intro,this._handlers.state=[T],T.call(this,{changed:i({},this._state),current:this._state}),this._fragment=function(e,t){var n,i;function s(e){return e.item.RenderStyle.iconUrl?N:x}var o=s(t),c=o(e,t);return{c:function(){n=d("span"),c.c(),n.className="legendIconCell style svelte-1vhs5pf"},m:function(e,t){a(e,n,t),c.m(n,null),i=!0},p:function(t,i){o===(o=s(i))&&c?c.p(t,i):(c.d(1),(c=o(e,i)).c(),c.m(n,null))},i:function(e,t){i||this.m(e,t)},o:r,d:function(e){e&&l(n),c.d()}}}(this,this._state),this.root._oncreate.push(function(){t.fire("update",{changed:i({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),y(this)),this._intro=!0}n(C.prototype,w),C.prototype._recompute=function(e,t){var n;e.item&&(this._differs(t.backgroundColor,t.backgroundColor=(n=t.item,L.gmxUtil.dec2rgba(n.RenderStyle.fillColor,n.RenderStyle.fillOpacity||1)))&&(e.backgroundColor=!0),this._differs(t.borderColor,t.borderColor=function(e){var t=e.item;return L.gmxUtil.dec2rgba(t.RenderStyle.color,t.RenderStyle.opacity||1)}(t))&&(e.borderColor=!0))};function I(e,t,n){var i=Object.create(e);return i.child=t[n],i}function D(e,t,n){var i=Object.create(e);return i.it=t[n],i}function E(e,t){var n,i,s,r="map"!==t.line.type&&M(e,t),o="map"!==t.line.type&&V(e,t);return{c:function(){r&&r.c(),n=u("\n "),o&&o.c(),i=h()},m:function(e,t){r&&r.m(e,t),a(e,n,t),o&&o.m(e,t),a(e,i,t),s=!0},p:function(t,s){"map"!==s.line.type?r?r.p(t,s):((r=M(e,s)).c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null),"map"!==s.line.type?(o?o.p(t,s):(o=V(e,s))&&o.c(),o.i(i.parentNode,i)):o&&o.o(function(){o.d(1),o=null})},i:function(e,t){s||this.m(e,t)},o:function(e){s&&(o?o.o(e):e(),s=!1)},d:function(e){r&&r.d(e),e&&l(n),o&&o.d(e),e&&l(i)}}}function M(e,t){var n,i,s="group"===t.line.type&&S(e,t),r="layer"===t.line.type&&P(e,t);return{c:function(){s&&s.c(),n=u("\n\t\t"),r&&r.c(),i=h()},m:function(e,t){s&&s.m(e,t),a(e,n,t),r&&r.m(e,t),a(e,i,t)},p:function(t,o){"group"===o.line.type?s?s.p(t,o):((s=S(e,o)).c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null),"layer"===o.line.type?r?r.p(t,o):((r=P(e,o)).c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d:function(e){s&&s.d(e),e&&l(n),r&&r.d(e),e&&l(i)}}}function S(e,t){var n,i,s;function r(t){e.clickOnExpander(this)}return{c:function(){n=d("input"),i=u("\n\t"),s=d("span"),n.className="expander expanderInput hidden svelte-137ivxp",m(n,"type","checkbox"),n.checked=t.isOpened,f(s,"click",r),s.className="expander pointer expanderCont cmd:clickOnExpander svelte-137ivxp"},m:function(e,t){a(e,n,t),a(e,i,t),a(e,s,t)},p:function(e,t){e.isOpened&&(n.checked=t.isOpened)},d:function(e){e&&(l(n),l(i),l(s)),p(s,"click",r)}}}function P(e,t){var n,i,s,r,c,h=t.properties.styles.length>1&&j(e,t),f=t.properties.description&&R(e,t),p=t.gmxTimeline&&t.properties.Temporal&&(t.properties.IsRasterCatalog||t.properties.Quicklook&&"null"!==t.properties.Quicklook)&&O(e,t);return{c:function(){h&&h.c(),n=u("\n\t"),i=d("span"),f&&f.c(),s=u("\n \t\t"),(r=d("span")).innerHTML='<svg role="img" class="svgIcon svelte-137ivxp"><use xlink:href="#center-on-click" href="#center-on-click"></use></svg>',c=u("\n\t\t\t\n\t\t"),p&&p.c(),r.className="pointer cmd:fitBounds cont-center svelte-137ivxp",r.title="Move map to this layer",i.className="icons  svelte-137ivxp"},m:function(e,t){h&&h.m(e,t),a(e,n,t),a(e,i,t),f&&f.m(i,null),o(i,s),o(i,r),o(i,c),p&&p.m(i,null)},p:function(t,r){r.properties.styles.length>1?h||((h=j(e,r)).c(),h.m(n.parentNode,n)):h&&(h.d(1),h=null),r.properties.description?f||((f=R(e,r)).c(),f.m(i,s)):f&&(f.d(1),f=null),r.gmxTimeline&&r.properties.Temporal&&(r.properties.IsRasterCatalog||r.properties.Quicklook&&"null"!==r.properties.Quicklook)?p||((p=O(e,r)).c(),p.m(i,null)):p&&(p.d(1),p=null)},d:function(e){h&&h.d(e),e&&(l(n),l(i)),f&&f.d(),p&&p.d()}}}function j(e,t){var n;return{c:function(){(n=d("span")).innerHTML='<svg role="img" class="svgIcon svelte-137ivxp"><use xlink:href="#overlays" href="#overlays"></use></svg>',n.className="cont-overlays svelte-137ivxp"},m:function(e,t){a(e,n,t)},d:function(e){e&&l(n)}}}function R(e,t){var n;function i(t){e.showInfo(this,t)}return{c:function(){(n=d("span")).innerHTML='<svg role="img" class="svgIcon svelte-137ivxp"><use xlink:href="#info-circle-i" href="#info-circle-i"></use></svg>',f(n,"click",i),n.className="pointer cmd:showInfo cont-info svelte-137ivxp",n.title="View description"},m:function(e,t){a(e,n,t)},d:function(e){e&&l(n),p(n,"click",i)}}}function O(e,t){var n;function i(t){e.toggleTimeline(this)}return{c:function(){(n=d("span")).innerHTML='<svg role="img" class="svgIcon svelte-137ivxp"><use xlink:href="#timeline-icon" href="#timeline-icon"></use></svg>',f(n,"click",i),n.className="pointer cmd:toggleTimeline timeline disabled svelte-137ivxp"},m:function(e,t){a(e,n,t)},d:function(e){e&&l(n),p(n,"click",i)}}}function V(e,t){var n,i,r,c,h,f,p,m,g,_,y=t.properties.title;function b(e){return"group"===e.line.type?U:B}var k=b(t),w=k(e,t),T="layer"===t.line.type&&t.styles.length&&t.styles.length<2&&t.styles[0].RenderStyle&&G(e,t),x="layer"===t.line.type&&H(e,t);return{c:function(){n=d("span"),w.c(),i=u("\n\t\t"),T&&T.c(),r=u("\n\t\t"),c=d("label"),h=u(y),p=u("\n\t\t"),m=d("div"),g=u("\n\t\t"),x&&x.c(),c.className=f="pointer title cmd:"+("group"===t.line.type?"toggleGroup":"toggleVisibility")+" "+t.multiStyles+" svelte-137ivxp",m.className="description collapse svelte-137ivxp",n.className="cont"},m:function(e,t){a(e,n,t),w.m(n,null),o(n,i),T&&T.m(n,null),o(n,r),o(n,c),o(c,h),o(n,p),o(n,m),o(n,g),x&&x.m(n,null),_=!0},p:function(t,s){k===(k=b(s))&&w?w.p(t,s):(w.d(1),(w=k(e,s)).c(),w.m(n,i)),"layer"===s.line.type&&s.styles.length&&s.styles.length<2&&s.styles[0].RenderStyle?(T?T.p(t,s):(T=G(e,s))&&T.c(),T.i(n,r)):T&&T.o(function(){T.d(1),T=null}),_&&!t.properties||y===(y=s.properties.title)||v(h,y),_&&!t.line&&!t.multiStyles||f===(f="pointer title cmd:"+("group"===s.line.type?"toggleGroup":"toggleVisibility")+" "+s.multiStyles+" svelte-137ivxp")||(c.className=f),"layer"===s.line.type?(x?x.p(t,s):(x=H(e,s))&&x.c(),x.i(n,null)):x&&x.o(function(){x.d(1),x=null})},i:function(e,t){_||this.m(e,t)},o:function(e){_&&(e=s(e,2),T?T.o(e):e(),x?x.o(e):e(),_=!1)},d:function(e){e&&l(n),w.d(),T&&T.d(),x&&x.d()}}}function B(e,t){var n,i;return{c:function(){(n=d("input")).className=i="check visibility pointer cmd:toggleVisibility "+t.line.type+" id:"+t.nodeID+" svelte-137ivxp",n.name=t.checkboxName,m(n,"type",t.checkboxType),n.checked=t.isVisible},m:function(e,t){a(e,n,t)},p:function(e,t){(e.line||e.nodeID)&&i!==(i="check visibility pointer cmd:toggleVisibility "+t.line.type+" id:"+t.nodeID+" svelte-137ivxp")&&(n.className=i),e.checkboxName&&(n.name=t.checkboxName),e.checkboxType&&m(n,"type",t.checkboxType),e.isVisible&&(n.checked=t.isVisible)},d:function(e){e&&l(n)}}}function U(e,t){var n,i=t.properties.ShowCheckbox&&A(e,t);return{c:function(){i&&i.c(),n=h()},m:function(e,t){i&&i.m(e,t),a(e,n,t)},p:function(t,s){s.properties.ShowCheckbox?i?i.p(t,s):((i=A(e,s)).c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d:function(e){i&&i.d(e),e&&l(n)}}}function A(e,t){var n,i;return{c:function(){(n=d("input")).className=i="check visibility pointer cmd:toggleGroup "+t.line.type+" id:"+t.nodeID+" svelte-137ivxp",n.name=t.checkboxName,m(n,"type",t.checkboxType),n.checked=t.isGroupVisible},m:function(e,t){a(e,n,t)},p:function(e,t){(e.line||e.nodeID)&&i!==(i="check visibility pointer cmd:toggleGroup "+t.line.type+" id:"+t.nodeID+" svelte-137ivxp")&&(n.className=i),e.checkboxName&&(n.name=t.checkboxName),e.checkboxType&&m(n,"type",t.checkboxType),e.isGroupVisible&&(n.checked=t.isGroupVisible)},d:function(e){e&&l(n)}}}function G(e,t){var n,i={item:t.styles[0],type:t.properties.GeometryType},s=new C({root:e.root,store:e.store,data:i});return{c:function(){s._fragment.c()},m:function(e,t){s._mount(e,t),n=!0},p:function(e,t){var n={};e.styles&&(n.item=t.styles[0]),e.properties&&(n.type=t.properties.GeometryType),s._set(n)},i:function(e,t){n||this.m(e,t)},o:function(e){n&&(s&&s._fragment.o(e),n=!1)},d:function(e){s.destroy(e)}}}function H(e,t){var n,i,s=t.styles.length&&t.styles.length>1&&t.styles[0].RenderStyle&&W(e,t);return{c:function(){s&&s.c(),n=h()},m:function(e,t){s&&s.m(e,t),a(e,n,t),i=!0},p:function(t,i){i.styles.length&&i.styles.length>1&&i.styles[0].RenderStyle?(s?s.p(t,i):(s=W(e,i))&&s.c(),s.i(n.parentNode,n)):s&&s.o(function(){s.d(1),s=null})},i:function(e,t){i||this.m(e,t)},o:function(e){i&&(s?s.o(e):e(),i=!1)},d:function(e){s&&s.d(e),e&&l(n)}}}function W(e,t){for(var n,i,r,u=t.styles,h=[],f=0;f<u.length;f+=1)h[f]=q(e,D(t,u,f));function p(e,t,n){h[e]&&h[e].o(function(){t&&(h[e].d(t),h[e]=null),n&&n()})}return{c:function(){n=d("div"),i=d("div");for(var e=0;e<h.length;e+=1)h[e].c();i.className="legend-cont svelte-137ivxp",n.className="legend svelte-137ivxp"},m:function(e,t){a(e,n,t),o(n,i);for(var s=0;s<h.length;s+=1)h[s].i(i,null);r=!0},p:function(t,n){if(t.styles||t.properties){u=n.styles;for(var s=0;s<u.length;s+=1){var r=D(n,u,s);h[s]?h[s].p(t,r):(h[s]=q(e,r),h[s].c()),h[s].i(i,null)}for(;s<h.length;s+=1)p(s,1)}},i:function(e,t){r||this.m(e,t)},o:function(e){if(r){for(var t=s(e,(h=h.filter(Boolean)).length),n=0;n<h.length;n+=1)p(n,0,t);r=!1}},d:function(e){e&&l(n),c(h,e)}}}function q(e,t){var n,i,s,r,c,h,f,p=t.it.Name,m={item:t.it,type:t.properties.GeometryType},g=new C({root:e.root,store:e.store,data:m});return{c:function(){n=d("div"),i=d("span"),s=u("\n\t\t\t\t\t\t"),g._fragment.c(),r=u("\n\t\t\t\t\t\t"),c=d("span"),h=u(p),i.className="legendIconEye enabled pointer cmd:toggleStyle svelte-137ivxp",c.className="styleName svelte-137ivxp",n.className="gmx-style-legend svelte-137ivxp"},m:function(e,t){a(e,n,t),o(n,i),o(n,s),g._mount(n,null),o(n,r),o(n,c),o(c,h),f=!0},p:function(e,t){var n={};e.styles&&(n.item=t.it),e.properties&&(n.type=t.properties.GeometryType),g._set(n),f&&!e.styles||p===(p=t.it.Name)||v(h,p)},i:function(e,t){f||this.m(e,t)},o:function(e){f&&(g&&g._fragment.o(e),f=!1)},d:function(e){e&&l(n),g.destroy()}}}function z(e,t){for(var n,i,r,o=t.line.content.children||[],u=[],h=0;h<o.length;h+=1)u[h]=Q(e,I(t,o,h));function f(e,t,n){u[e]&&u[e].o(function(){t&&(u[e].d(t),u[e]=null),n&&n()})}return{c:function(){n=d("ul");for(var e=0;e<u.length;e+=1)u[e].c();n.className=i="group css-treeview id_"+t.nodeID+" "+(t.isOpened||t.isRoot?"":"collapse")+" "+t.isRadio+" svelte-137ivxp"},m:function(t,i){a(t,n,i);for(var s=0;s<u.length;s+=1)u[s].i(n,null);e.refs.ul=n,r=!0},p:function(t,s){if(t.line||t.layersTree||t.gmxTimeline){o=s.line.content.children||[];for(var a=0;a<o.length;a+=1){var l=I(s,o,a);u[a]?u[a].p(t,l):(u[a]=Q(e,l),u[a].c()),u[a].i(n,null)}for(;a<u.length;a+=1)f(a,1)}(!r||t.nodeID||t.isOpened||t.isRoot||t.isRadio)&&i!==(i="group css-treeview id_"+s.nodeID+" "+(s.isOpened||s.isRoot?"":"collapse")+" "+s.isRadio+" svelte-137ivxp")&&(n.className=i)},i:function(e,t){r||this.m(e,t)},o:function(e){if(r){for(var t=s(e,(u=u.filter(Boolean)).length),n=0;n<u.length;n+=1)f(n,0,t);r=!1}},d:function(t){t&&l(n),c(u,t),e.refs.ul===n&&(e.refs.ul=null)}}}function Q(e,t){var n,i={},s={line:t.child,parentProps:t.line.content.properties};void 0!==t.layersTree&&(s.layersTree=t.layersTree,i.layersTree=!0),void 0!==t.gmxTimeline&&(s.gmxTimeline=t.gmxTimeline,i.gmxTimeline=!0);var r=new Z({root:e.root,store:e.store,data:s,_bind:function(t,n){var s={};!i.layersTree&&t.layersTree&&(s.layersTree=n.layersTree),!i.gmxTimeline&&t.gmxTimeline&&(s.gmxTimeline=n.gmxTimeline),e._set(s),i={}}});return e.root._beforecreate.push(function(){r._bind({layersTree:1,gmxTimeline:1},r.get())}),{c:function(){r._fragment.c()},m:function(e,t){r._mount(e,t),n=!0},p:function(e,n){t=n;var s={};e.line&&(s.line=t.child),e.line&&(s.parentProps=t.line.content.properties),!i.layersTree&&e.layersTree&&(s.layersTree=t.layersTree,i.layersTree=void 0!==t.layersTree),!i.gmxTimeline&&e.gmxTimeline&&(s.gmxTimeline=t.gmxTimeline,i.gmxTimeline=void 0!==t.gmxTimeline),r._set(s),i={}},i:function(e,t){n||this.m(e,t)},o:function(e){n&&(r&&r._fragment.o(e),n=!1)},d:function(e){r.destroy(e)}}}function Z(e){var t,i,r,c,h,f,p,m,v;b(this,e),this.refs={},this._state=n({line:null},e.data),this._recompute({parentProps:1,line:1,properties:1,layersTree:1},this._state),this._intro=!!e.intro,this._fragment=(t=this,i=this._state,m=i.properties&&E(t,i),v=i.line.content.children&&z(t,i),{c:function(){r=d("li"),c=d("div"),m&&m.c(),h=u("\n\n"),v&&v.c(),c.className="mega",r.className=f="line cmd:toggleIcons id:"+i.nodeID+" "+i.line.type+" svelte-137ivxp"},m:function(e,n){a(e,r,n),o(r,c),m&&m.m(c,null),o(r,h),v&&v.m(r,null),t.refs.line=r,p=!0},p:function(e,n){n.properties?(m?m.p(e,n):(m=E(t,n))&&m.c(),m.i(c,null)):m&&m.o(function(){m.d(1),m=null}),n.line.content.children?(v?v.p(e,n):(v=z(t,n))&&v.c(),v.i(r,null)):v&&v.o(function(){v.d(1),v=null}),p&&!e.nodeID&&!e.line||f===(f="line cmd:toggleIcons id:"+n.nodeID+" "+n.line.type+" svelte-137ivxp")||(r.className=f)},i:function(e,t){p||this.m(e,t)},o:function(e){p&&(e=s(e,2),m?m.o(e):e(),v?v.o(e):e(),p=!1)},d:function(e){e&&l(r),m&&m.d(),v&&v.d(),t.refs.line===r&&(t.refs.line=null)}}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),y(this)),this._intro=!0}n(Z.prototype,w),n(Z.prototype,{clickOnExpander:function(e){if("group"===this.get().line.type){var t=this.refs.ul;t&&t.classList[t.classList.contains("collapse")?"remove":"add"]("collapse")}},toggleTimeline:function(e){e&&(e.classList.contains("disabled")?(e.classList.remove("disabled"),e.classList.add("enabled")):(e.classList.add("disabled"),e.classList.remove("enabled")))},showInfo:function(e){var t=e.parentNode.nextElementSibling.getElementsByClassName("description")[0];if(t)if(t.classList.contains("collapse")){var n=this.get().line;t.innerHTML=n.content.properties.description||"",t.classList.remove("collapse")}else t.classList.add("collapse")}}),Z.prototype._recompute=function(e,t){var n;e.parentProps&&(this._differs(t.checkboxType,t.checkboxType=(n=t.parentProps)&&n.list?"radio":"checkbox")&&(e.checkboxType=!0),this._differs(t.checkboxName,t.checkboxName=function(e){var t=e.parentProps;return t&&t.GroupID||""}(t))&&(e.checkboxName=!0)),e.line&&this._differs(t.properties,t.properties=function(e){return e.line.content.properties}(t))&&(e.properties=!0),e.properties&&(this._differs(t.isRadio,t.isRadio=function(e){return e.properties.list?"radio":"checkbox"}(t))&&(e.isRadio=!0),this._differs(t.nodeID,t.nodeID=function(e){var t=e.properties;return t?t.name||t.GroupID:"root"}(t))&&(e.nodeID=!0),this._differs(t.styles,t.styles=function(e){var t=e.properties;return t.gmxStyles?t.gmxStyles.styles:[]}(t))&&(e.styles=!0),this._differs(t.multiStyles,t.multiStyles=function(e){var t=e.properties;return t.gmxStyles&&t.gmxStyles.styles.length>1?"multiStyles":""}(t))&&(e.multiStyles=!0),this._differs(t.isRoot,t.isRoot=function(e){return e.properties.MapID}(t))&&(e.isRoot=!0)),(e.line||e.layersTree)&&(this._differs(t.isOpened,t.isOpened=function(e){var t=e.line,n=e.layersTree,i=t.content.properties.GroupID||"root";return n.expanded[i]}(t))&&(e.isOpened=!0),this._differs(t.isGroupVisible,t.isGroupVisible=function(e){var t=e.line,n=e.layersTree,i=t.content.properties.GroupID||"root";return n.visible[i]}(t))&&(e.isGroupVisible=!0),this._differs(t.isVisible,t.isVisible=function(e){var t=e.line;return e.layersTree.visible[t.content.properties.name]}(t))&&(e.isVisible=!0))};var J={cmd:/cmd:(\w+)/,id:/id:(\w+)/};var F={chkEvent:function(e){var t=e.target,n=t.className,i=J.cmd.exec(n);if(i&&2===i.length){for(var s={cmd:i[1],type:e.type,originalEvent:e},r=0;r<10;r++){if(t.classList.contains("line")){s.nodeType=t.classList.contains("layer")?"layer":"group",s.id=this._getId(t.className),s.target=t;break}t=t.parentNode}s.id&&(this.treeCommands(s),this.fire("command",s))}},_getId:function(e){var t=J.id.exec(e);return t&&2===t.length?t[1]:""},_isExistVisible:function(e,t){for(var n=0,i=e.children.length,s=0;s<i;s++){var r=e.children[s],o=this._getId(r.className);t.visible[o]&&n++}return 0===n?0:n===i?1:.5},_toggleParents:function(e,t,n){for(var i=!0;i;)if((e=e.parentNode).classList.contains("line")){var s=this._getId(e.className);s&&(n.visible[s]=t)}else e.classList.contains("group")?!t&&this._isExistVisible(e,n)&&(i=!1):i=!1},_uncheckRadio:function(e,t,n){for(var i=0,s=e.children.length;i<s;i++){var r=e.children[i],o=this._getId(r.className);o!==t&&(this.fire("command",{id:o,set:!1,cmd:"toggleNode"}),n.visible[o]=!1)}},_iterateNodeChilds:function(e,t,n){var i=this._getId(e.className),s=e.classList.contains("group"),r=e.getElementsByTagName("ul")[0];if(n.visible[i]=t,s?n.expanded[i]=t:this.fire("command",{id:i,set:t,cmd:"toggleNode"}),r)for(var o=r.classList.contains("radio"),a=t,l=0,c=r.children.length;l<c;l++){var d=r.children[l];this._getId(d.className);o&&l&&(a=!1),this._iterateNodeChilds(d,a,n)}},treeCommands:function(e){var t=this.get(),n=t.layersTree,i=(t.rawTree,e.id),s=(e.nodeType,!n.expanded[i]),r=!n.visible[i];n.options[i],e.type,e.nodeType,e.originalEvent;if("clickOnExpander"===e.cmd)n.expanded[i]=!n.expanded[i],this.set({layersTree:n});else if("toggleGroup"===e.cmd)this._iterateNodeChilds(e.target,r,n),this._toggleParents(e.target,s,n),this.set({layersTree:n});else if("toggleVisibility"===e.cmd){var o=e.target,a=o.getElementsByClassName("expanderInput")[0]?n.expanded:n.visible,l=o.parentNode;return a[i]?delete a[i]:a[i]=!0,l&&l.classList.contains("radio")&&this._uncheckRadio(l,i,n),this._toggleParents(e.target,a[i],n),this.set({layersTree:n}),!0}return!1},appendNode:function(e){this.options.appendNode(e)}};function K(e){b(this,e),this._state=n({config:{},layersTree:{visible:{},expanded:{}},group:null,rawTree:null},e.data),this._intro=!!e.intro,this._fragment=function(e,t){var n,i,s={},r={line:t.rawTree,parentProps:t.rawTree.content.properties};void 0!==t.layersTree&&(r.layersTree=t.layersTree,s.layersTree=!0),void 0!==t.gmxTimeline&&(r.gmxTimeline=t.gmxTimeline,s.gmxTimeline=!0);var o=new Z({root:e.root,store:e.store,data:r,_bind:function(t,n){var i={};!s.layersTree&&t.layersTree&&(i.layersTree=n.layersTree),!s.gmxTimeline&&t.gmxTimeline&&(i.gmxTimeline=n.gmxTimeline),e._set(i),s={}}});function c(t){e.chkEvent(t)}return e.root._beforecreate.push(function(){o._bind({layersTree:1,gmxTimeline:1},o.get())}),{c:function(){n=d("div"),o._fragment.c(),f(n,"click",c),n.className="TreeView svelte-aljqq6"},m:function(e,t){a(e,n,t),o._mount(n,null),i=!0},p:function(e,n){t=n;var i={};e.rawTree&&(i.line=t.rawTree),e.rawTree&&(i.parentProps=t.rawTree.content.properties),!s.layersTree&&e.layersTree&&(i.layersTree=t.layersTree,s.layersTree=void 0!==t.layersTree),!s.gmxTimeline&&e.gmxTimeline&&(i.gmxTimeline=t.gmxTimeline,s.gmxTimeline=void 0!==t.gmxTimeline),o._set(i),s={}},i:function(e,t){i||this.m(e,t)},o:function(e){i&&(o&&o._fragment.o(e),i=!1)},d:function(e){e&&l(n),o.destroy(),p(n,"click",c)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),y(this)),this._intro=!0}n(K.prototype,w),n(K.prototype,F);var X=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),$=function(){function e(){X(this,e),this.listeners={}}return Y(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"on",value:function(e,t){return this.addEventListener(e,t),this}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],i=0,s=n.length;i<s;i++)if(n[i]===t)return n.splice(i,1),this.removeEventListener(e,t)}},{key:"off",value:function(e,t){return this.removeEventListener(e,t),this}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){var t=this.listeners[e.type];Object.defineProperty(e,"target",{enumerable:!1,configurable:!1,writable:!1,value:this});for(var n=0,i=t.length;n<i;n++)t[n].call(this,e)}}}]),e}();class ee extends ${constructor(e,{position:t="left"}={}){super(),this._container=e,this._container.classList.add("noselect"),this._container.innerHTML=`<div class="scanex-sidebar">\n            <div class="${"left"===t?"tabs":"panes"}"></div>\n            <div class="${"left"===t?"panes":"tabs"}"></div>\n        </div>`,this._tabContainer=this._container.querySelector(".tabs"),this._paneContainer=this._container.querySelector(".panes"),this._current=null,this._data={}}enable(e){this._data[e]&&(this._data[e].enabled=!0)}enabled(e){const{enabled:t}=e&&this._data[e]?this._data[e]:{enabled:!1};return t}disable(e){this._data[e]&&(e===this.current&&(this.current=null),this._data[e].enabled=!1)}get current(){return this._current}set current(e){const t=this._tabContainer.children,n=this._paneContainer.children;let i=!1;for(let s=0;s<t.length;++s){const r=t[s].getAttribute("data-tab-id"),{opened:o,closed:a,enabled:l}=this._data[r];let c=t[s].querySelector("i"),d=n[s];r===e?(c.classList.remove(a),c.classList.add(o),d.classList.remove("hidden"),d.classList.add("shown"),i=!0):(c.classList.remove(o),c.classList.add(a),d.classList.remove("shown"),d.classList.add("hidden"))}this._current=i?e:null;let s=document.createEvent("Event");s.detail={current:this._current},s.initEvent("change",!1,!1),this.dispatchEvent(s)}addTab({id:e,icon:t,opened:n,closed:i,tooltip:s,enabled:r=!0}){let o=document.createElement("div"),a=document.createElement("i");t.split(/\s+/g).forEach(e=>a.classList.add(e)),a.classList.add(e===this._current?n:i),o.appendChild(a),o.setAttribute("data-tab-id",e),s&&o.setAttribute("title",s),o.addEventListener("click",this._toggle.bind(this,e)),this._tabContainer.appendChild(o);let l=document.createElement("div");return l.setAttribute("data-pane-id",e),l.classList.add(this.visible&&this.current===e?"shown":"hidden"),this._paneContainer.appendChild(l),this._data[e]={icon:t,opened:n,closed:i,enabled:r},l}removeTab(e){const t=this._tabContainer.querySelector(`[data-tab-id=${e}]`);t.removeEventListener("click",this._toggle.bind(this,e)),this._tabContainer.removeChild(t);const n=this._paneContainer.querySelector(`[data-pane-id=${e}]`);this._paneContainer.removeChild(n);for(let t=0;t<this._data.length;++t)if(this._data[t].id===e){this._data.splice(t,1);break}}_toggle(e){this.enabled(e)&&(this.current=this.current===e?null:e)}getPane(e){return this._paneContainer.querySelector(`[data-pane-id=${e}]`)}}var te=L.Control.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,initialize:function(e){L.setOptions(this,e)},enable:function(e){this._sidebar.enable(e)},enabled:function(e){return this._sidebar.enabled(e)},disable:function(e){this._sidebar.disable(e)},getCurrent:function(){return this._sidebar.current},setCurrent:function(e){this._sidebar.current=e},addTab:function({id:e,icon:t,opened:n,closed:i,tooltip:s,enabled:r}){return this._sidebar.addTab({id:e,icon:t,opened:n,closed:i,tooltip:s,enabled:r})},removeTab:function(e){this._sidebar.removeTab(e)},getPane:function(e){return this._sidebar.getPane(e)},onAdd:function(e){this._container=L.DomUtil.create("div"),L.DomEvent.disableClickPropagation(this._container),L.DomEvent.disableScrollPropagation(this._container);const{position:t}=this.options;return this._sidebar=new ee(this._container,{position:"topleft"===t||"bottomleft"===t?"left":"right"}),this._sidebar.addEventListener("change",e=>{this.fire("change",e)}),this._container},addTo:function(e){return L.Control.prototype.addTo.call(this,e),this.options.addBefore&&this.addBefore(this.options.addBefore),this},addBefore:function(e){let t=this._parent&&this._parent._container;if(t||(t=this._map&&this._map._controlCorners[this.getPosition()]),t)for(let n=0,i=t.childNodes.length;n<i;n++){let i=t.childNodes[n];if(e===i._id){t.insertBefore(this._container,i);break}}else this.options.addBefore=e;return this}});var ne,ie=(function(t){var n;n=function(e){function t(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n,e)}function n(e,t){e.children.length?e.insertBefore(t,e.children[0]):e.appendChild(t)}var i=e.Control.extend({includes:e.Evented?e.Evented.prototype:e.Mixin.Events,_getActiveLayer:function(){return this._activeLayerId?this._layers[this._activeLayerId]:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t}(this._layers)?function(e){for(var t in e)if(e.hasOwnProperty(t))return e[t]}(this._layers):null},_getPreviousLayer:function(){var e=this._getActiveLayer();return e?this._previousLayerId?this._layers[this._previousLayerId]:function(e,t){if(e.length){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}else for(var i in e)if(e.hasOwnProperty(i)&&t(e[i]))return e[i]}(this._layers,function(t){return t.id!==e.id}.bind(this))||null:null},_getInactiveLayers:function(){var e=[],n=this._getActiveLayer()?this._getActiveLayer().id:null,i=this._getPreviousLayer()?this._getPreviousLayer().id:null;return t(this._layers,function(t){t.id!==n&&t.id!==i&&e.push(t)}),e},_arrangeLayers:function(){var e={previous:function(){var e=this._getInactiveLayers();return this._getActiveLayer()&&e.unshift(this._getActiveLayer()),this._getPreviousLayer()&&e.unshift(this._getPreviousLayer()),e}};return e[this.options.behavior].apply(this,arguments)},_getLayerCellByLayerId:function(e){for(var t=this._container.getElementsByClassName("leaflet-iconLayers-layerCell"),n=0;n<t.length;n++)if(t[n].getAttribute("data-layerid")==e)return t[n]},_createLayerElement:function(t){var n=e.DomUtil.create("div","leaflet-iconLayers-layer");if(t.title){var i=e.DomUtil.create("div","leaflet-iconLayers-layerTitleContainer"),s=e.DomUtil.create("div","leaflet-iconLayers-layerTitle"),r=e.DomUtil.create("div","leaflet-iconLayers-layerCheckIcon");s.innerHTML=t.title,i.appendChild(s),n.appendChild(i),n.appendChild(r)}return t.icon&&n.setAttribute("style","background-image: url('"+t.icon+"')"),n},_createLayerElements:function(){for(var t,i,s=this._arrangeLayers(),r=this._getActiveLayer()&&this._getActiveLayer().id,o=0;o<s.length;o++)o%this.options.maxLayersInRow==0&&(t=e.DomUtil.create("div","leaflet-iconLayers-layersRow"),-1===this.options.position.indexOf("bottom")?this._container.appendChild(t):n(this._container,t)),(i=e.DomUtil.create("div","leaflet-iconLayers-layerCell")).setAttribute("data-layerid",s[o].id),0!==o&&e.DomUtil.addClass(i,"leaflet-iconLayers-layerCell_hidden"),s[o].id===r&&e.DomUtil.addClass(i,"leaflet-iconLayers-layerCell_active"),"left"===this._expandDirection?e.DomUtil.addClass(i,"leaflet-iconLayers-layerCell_expandLeft"):e.DomUtil.addClass(i,"leaflet-iconLayers-layerCell_expandRight"),i.appendChild(this._createLayerElement(s[o])),-1===this.options.position.indexOf("right")?t.appendChild(i):n(t,i)},_onLayerClick:function(e){e.stopPropagation();var t=e.currentTarget.getAttribute("data-layerid"),n=this._layers[t];this.setActiveLayer(n.layer),this.expand()},_attachEvents:function(){t(this._layers,function(e){var t=this._getLayerCellByLayerId(e.id);t&&t.addEventListener("click",this._onLayerClick.bind(this))}.bind(this));for(var e=this._container.getElementsByClassName("leaflet-iconLayers-layersRow"),n=function(e){e.stopPropagation(),this.expand()}.bind(this),i=function(e){e.stopPropagation(),this.collapse()}.bind(this),s=function(e){e.stopPropagation()},r=0;r<e.length;r++){var o=e[r];o.addEventListener("mouseenter",n),o.addEventListener("mouseleave",i),o.addEventListener("mousemove",s)}},_render:function(){this._container.innerHTML="",this._createLayerElements(),this._attachEvents()},_switchMapLayers:function(){if(this._map){var e=this._getActiveLayer(),n=this._getPreviousLayer();n?this._map.removeLayer(n.layer):t(this._layers,function(e){var t=e.layer;this._map.removeLayer(t)}.bind(this)),e&&this._map.addLayer(e.layer)}},options:{position:"bottomleft",behavior:"previous",expand:"horizontal",autoZIndex:!0,maxLayersInRow:5,manageLayers:!0},initialize:function(t,n){e.Util.isArray(arguments[0])||(n=t,t=[]),e.setOptions(this,n),this._expandDirection=-1!=this.options.position.indexOf("left")?"right":"left",this.options.manageLayers&&this.on("activelayerchange",this._switchMapLayers,this),this.setLayers(t)},onAdd:function(t){return this._container=e.DomUtil.create("div","leaflet-iconLayers"),e.DomUtil.addClass(this._container,"leaflet-iconLayers_"+this.options.position),this._render(),t.on("click",this.collapse,this),this.options.manageLayers&&this._switchMapLayers(),this._container},onRemove:function(e){e.off("click",this.collapse,this)},setLayers:function(t){this._layers={},t.map(function(t){var n=e.stamp(t.layer);this._layers[n]=e.extend(t,{id:n})}.bind(this)),this._container&&this._render()},setActiveLayer:function(t){var n=t&&this._layers[e.stamp(t)];n&&n.id!==this._activeLayerId&&(this._previousLayerId=this._activeLayerId,this._activeLayerId=n.id,this._container&&this._render(),this.fire("activelayerchange",{layer:t}))},expand:function(){this._arrangeLayers().slice(1).map(function(t){var n=this._getLayerCellByLayerId(t.id);e.DomUtil.removeClass(n,"leaflet-iconLayers-layerCell_hidden")}.bind(this))},collapse:function(){this._arrangeLayers().slice(1).map(function(t){var n=this._getLayerCellByLayerId(t.id);e.DomUtil.addClass(n,"leaflet-iconLayers-layerCell_hidden")}.bind(this))}}),s=function(e,t){return new i(e,t)};return s.Constructor=i,s},t.exports?t.exports=n(e):(window.L.control.iconLayers=n(window.L),window.L.Control.IconLayers=window.L.control.iconLayers.Constructor)}(ne={exports:{}},ne.exports),ne.exports);window.serverBase;var se={createMap:function(e){var t=this.get().layersTree,n=e.app||{},i=n.gmxMap||{},s=e.state||{},r=(s.calendar,i.mapID||"946GH"),o=i.apiKey||"Z2SSNR87N4",a=s.map?s.map.position:{};n.theme&&document.body.classList.add(n.theme),L.leafletMap&&L.leafletMap.remove(),(t=s.layersTree||t).options=t.options||{},this.layersTree=t;var l=new L.Map("map",{srs:3857,layers:[],center:new L.LatLng(a.y||0,a.x||60),zoom:a.z||3});if(L.leafletMap=l,l.gmxControlsManager.init({gmxDrawing:n.drawing&&"false"!==n.drawing?{position:"right"}:null,gmxZoom:{position:"gmxbottomright"},gmxHide:null}),l.gmxControlsManager.setSvgSprites("//www.kosmosnimki.ru/lib/geomixer_1.3/img/svg-symbols.svg"),n.iconSidebar&&"false"!==n.iconSidebar){var c=new te({position:"topleft"});if(c.addTo(l),this.iconSidebar=c,n.treeView&&"false"!==n.treeView){var d=c.addTab({id:"treeView",icon:"icon-layers",opened:"opened",closed:"closed"});this.treePane=d}}else document.body.classList.add("noIconSidebar");this.mapID=r;var u={leafletMap:l,apiKey:o,setZIndex:!0};L.gmx.loadMap(r,u).then(function(e){var i=this;this.gmxMap=e;var r=s.calendar||{},o=r.dateBegin,a=r.dateEnd;if(!o){var c=new Date;a=(o=Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()))+864e5}var u=new Date(o),h=new Date(a);e.layers.forEach(function(e){if(e.getGmxProperties){var n=e.getGmxProperties().name;e.setDateInterval&&e.setDateInterval(u,h),n in t.visible&&l[t.visible[n]?"addLayer":"removeLayer"](e)}}),L.gmx.gmxMapManager.iterateNode(e.rawTree,function(e,n){var i=e.content.properties,s=i.name||i.GroupID;if(i.GroupID)!i.expanded||s in t.expanded||(t.expanded[s]=i.expanded),!i.visible||s in t.visible||(t.visible[s]=i.visible);else{!i.visible||s in t.visible||(t.visible[s]=i.visible);var r=n.properties;if(r.GroupID&&r.list){var o=t.options[s]||{};o.list=r.list,t.options[s]=o}}},{nodes:e.nodes});var f=!1,p=null;if(n.gmxTimeline&&"false"!==n.gmxTimeline){var m=L.control.gmxTimeline({moveable:!0}).on("dateInterval",function(t){e.layersByID[t.layerID].setDateInterval(t.beginDate,t.endDate)}).on("statechanged",function(){p()}).on("click",function(t){e.layersByID[t.layerID].repaint()});this.gmxTimeline=m,p=function(){m._container&&(m._container.classList[f?"add":"remove"]("shiftTimeline"),m._redrawTimeline())}}if(this.iconSidebar){this.iconSidebar.on("change",function(n){return"treeView"===n.detail.current?(f=!0,d&&i._initTree({container:d,layersTree:t,rawTree:e.rawTree,gmxTimeline:i.gmxTimeline})):(f=!1,d&&(d.innerHTML="")),i.IconLayersContainer&&i.IconLayersContainer.classList[f?"add":"remove"]("shiftIconLayers"),void(p&&p())})}var v=s.baseLayersManager||{activeIDs:e.properties.BaseLayers};this._initBaseLayers(l,v,n)}.bind(this)).catch(console.log),this.set({map:l,config:e})},_initBaseLayers:function(e,t,n){var i=e.gmxBaseLayersManager,s=t.activeIDs||["sputnik"],r=t.currentID||s[0];i.initDefaults().then(function(){i.setActiveIDs(s);var t=i.getActiveIDs().map(function(e){var t=i.get(e);return t?{layer:t,icon:t.options.icon,title:t.options.rus}:null}).filter(function(e){return e});if(n.iconLayers&&"false"!==n.iconLayers){var o=new ie(t,{id:"iconLayers"});e.gmxControlsManager.add(o),e.addControl(o),o.setActiveLayer(i.get(r)),this.IconLayersContainer=o.getContainer()}i.setCurrentID(r),"opened"===n.treeView&&this.iconSidebar&&this.iconSidebar.setCurrent("treeView")}.bind(this))},_getNodeIndex:function(e){var t,n,i=e.parentNode.children;for(t=0,n=i.length;t<n&&i[t]!==e;t++);return t===n?null:t},_initTree:function(e){var t=this,n={type:"map",content:e.rawTree};this._treeView=new K({appendNode:function(e){},target:e.container,data:{container:e.container,layersTree:e.layersTree,gmxTimeline:!!e.gmxTimeline,rawTree:n}}),this._treeView.on("command",function(e){var n=t.get().map,i=e.cmd,s=e.originalEvent?e.originalEvent.target:null,r=(t.layersTree,t.gmxMap),o=!r.nodes||r.nodes[e.id],a=r.layersByID[e.id];if(a){if("fitBounds"===i)n.fitBounds(a.getBounds());else if("toggleNode"===i){e.set?a._map||n.addLayer(a):a._map&&n.removeLayer(a)}else if("toggleVisibility"===i)a._map?n.removeLayer(a):n.addLayer(a);else if("toggleTimeline"===i&&t.gmxTimeline)s.classList.contains("enabled")?(t.gmxTimeline._map||n.addControl(t.gmxTimeline),t.gmxTimeline.addLayer(a)):t.gmxTimeline.removeLayer(a);else if("toggleStyle"===i){var l=t._getNodeIndex(s.parentNode),c=a.getStyles();s.classList.contains("enabled")?(s.classList.remove("enabled"),c[l].disabled=!0):(s.classList.add("enabled"),delete c[l].disabled),a.setStyles(c)}}else"toggleVisibility"!==i||o||t._treeView.appendNode(e.id)})}};function re(e){var t=e.changed,n=e.current;e.previous;t.permalink&&n.permalink&&this.createMap(n.permalink)}function oe(e){var s,o,c=this;b(this,e),this._state=n({layersTree:{options:{},visible:{},expanded:{}},permalink:null,map:null},e.data),this._intro=!!e.intro,this._handlers.state=[re],re.call(this,{changed:i({},this._state),current:this._state}),this._fragment=(this._state,{c:function(){(s=d("div")).id="map"},m:function(e,t){a(e,s,t),o=!0},p:t,i:function(e,t){o||this.m(e,t)},o:r,d:function(e){e&&l(s)}}),this.root._oncreate.push(function(){c.fire("update",{changed:i({},c._state),current:c._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),y(this)),this._intro=!0}function ae(e,t){var n,i;return{c:function(){n=d("h3"),i=u(t.title),n.className="popover-title"},m:function(e,t){a(e,n,t),o(n,i)},p:function(e,t){e.title&&v(i,t.title)},d:function(e){e&&l(n)}}}function le(e){b(this,e),this._state=n({frameWidth:800,frameHeight:600,conf:"R6UIY",title:""},e.data),this._recompute({conf:1},this._state),this._intro=!!e.intro,this._fragment=function(e,t){var n,i,s,c,h,v,g,_,y,b,k,w,T,x,N,L,C,I,D,E,M,S,P,j,R,O,V,B,U,A,G,H,W,q,z,Q,Z,J,F,K,X,Y,$,ee,te,ne,ie,se,re,oe,le,ce,de,ue,he,fe,pe,me,ve,ge,_e=t.title&&ae(0,t);function ye(t){e.set({frameWidth:this.value})}function be(t){e.set({frameHeight:this.value})}return{c:function(){n=d("div"),i=d("div"),s=u("\n\t"),_e&&_e.c(),c=u("\n\t"),h=d("div"),v=d("div"),g=d("div"),_=d("div"),(y=d("span")).textContent="Ссылка на карту:",b=u("\n\t\t\t\t\t"),k=d("a"),w=d("i"),x=u("\n\t\t\t\t\t"),N=d("a"),L=d("i"),I=u("\n\t\t\t\t\t"),D=d("a"),E=d("i"),S=u("\n\t\t\t\t"),P=d("div"),j=d("div"),R=d("input"),O=u("\n\t\t\t\t\t\t"),V=d("a"),B=d("i"),U=u("\n\t\t\t\t"),(A=d("div")).textContent="Код для вставки:",G=u("\n\t\t\t\t"),H=d("div"),W=d("div"),q=d("input"),z=u("\n\t\t\t\t\t\t\t"),(Q=d("span")).textContent="x",Z=u("\n\t\t\t\t\t\t\t"),J=d("input"),F=u("\n\t\t\t\t\t\t"),(K=d("span")).innerHTML='<span>предпросмотр</span><i class="icon-link-ext svelte-1cva6jy"></i>',X=u("\n\t\t\t\t\t\t"),Y=d("span"),$=d("a"),ee=u("конструктор приложений"),ne=d("i"),ie=u("\n\t\t\t\t"),se=d("div"),re=d("textarea"),le=u("\n\t\t\t\t\t"),(ce=d("div")).innerHTML='<div class="alertWidget ui-widget"></div>',de=u("\n\t\t\t\t"),ue=d("div"),he=d("span"),fe=d("a"),pe=u("предпросмотр"),ve=d("i"),i.className="arrow svelte-1cva6jy",y.className="bold svelte-1cva6jy",w.className="icon-twitter svelte-1cva6jy",k.className="gmx-link_icon svelte-1cva6jy",k.target="_blank",k.href=T="//www.twitter.com/share?url="+t.link,L.className="icon-facebook svelte-1cva6jy",N.className="gmx-link_icon svelte-1cva6jy",N.target="_blank",N.href=C="https://www.facebook.com/sharer/sharer.php?u="+t.link,E.className="icon-vk svelte-1cva6jy",D.className="gmx-link_icon svelte-1cva6jy",D.target="_blank",D.href=M="//vkontakte.ru/share.php?url"+t.link,_.className="shareDialog-row shareDialog-title svelte-1cva6jy",R.className="shareDialog-inputPermalinkUrl svelte-1cva6jy",m(R,"type","text"),R.readOnly="readonly",R.value=t.link,B.className="icon-link-ext svelte-1cva6jy",B.title="открыть в новом окне",V.className="gmx-link_icon svelte-1cva6jy",V.target="_blank",V.href=t.link,j.className="gmx-table",P.className="shareDialog-row svelte-1cva6jy",A.className="shareDialog-row bold svelte-1cva6jy",f(q,"change",ye),q.className=" svelte-1cva6jy",m(q,"type","number"),q.value=t.frameWidth,Q.className="shareDialog-resolutionCross",f(J,"change",be),J.className=" svelte-1cva6jy",m(J,"type","number"),J.value=t.frameHeight,K.className="shareDialog-validationError hidden svelte-1cva6jy",$.className="shareDialog-previewLink gmx-link svelte-1cva6jy",$.href=te=t.link+"&edit=1",$.target="_blank",ne.className="gmx-icon icon-link-ext svelte-1cva6jy",Y.className="shareDialog-previewLinkCell constrLink shareDialog-validationOk svelte-1cva6jy",W.className="gmx-table shareDialog-resolutionTable svelte-1cva6jy",H.className="shareDialog-row svelte-1cva6jy",re.className="shareDialog-validationOk svelte-1cva6jy",re.readOnly="readonly",re.value=oe='<iframe src="'+t.link+'" width="'+t.frameWidth+'" height="'+t.frameHeight+'"></iframe>',ce.className="shareDialog-validationErrorView hidden svelte-1cva6jy",se.className="shareDialog-row svelte-1cva6jy",fe.className="shareDialog-previewLink gmx-link svelte-1cva6jy",fe.href=me="//www.kosmosnimki.ru/demo/winnie_2.0/iframePreview.html?width="+t.frameWidth+"&height="+t.frameHeight+"&url="+t.link,fe.target="_blank",ve.className="gmx-icon icon-link-ext svelte-1cva6jy",he.className="shareDialog-previewLinkCell shareDialog-validationOk svelte-1cva6jy",ue.className="shareDialog-row svelte-1cva6jy",g.className="shareDialog",v.className="shareDialogContainer",h.className="popover-content svelte-1cva6jy",n.className="share svelte-1cva6jy"},m:function(e,t){a(e,n,t),o(n,i),o(n,s),_e&&_e.m(n,null),o(n,c),o(n,h),o(h,v),o(v,g),o(g,_),o(_,y),o(_,b),o(_,k),o(k,w),o(_,x),o(_,N),o(N,L),o(_,I),o(_,D),o(D,E),o(g,S),o(g,P),o(P,j),o(j,R),o(j,O),o(j,V),o(V,B),o(g,U),o(g,A),o(g,G),o(g,H),o(H,W),o(W,q),o(W,z),o(W,Q),o(W,Z),o(W,J),o(W,F),o(W,K),o(W,X),o(W,Y),o(Y,$),o($,ee),o(Y,ne),o(g,ie),o(g,se),o(se,re),o(se,le),o(se,ce),o(g,de),o(g,ue),o(ue,he),o(he,fe),o(fe,pe),o(he,ve),ge=!0},p:function(e,t){t.title?_e?_e.p(e,t):((_e=ae(0,t)).c(),_e.m(n,c)):_e&&(_e.d(1),_e=null),e.link&&T!==(T="//www.twitter.com/share?url="+t.link)&&(k.href=T),e.link&&C!==(C="https://www.facebook.com/sharer/sharer.php?u="+t.link)&&(N.href=C),e.link&&M!==(M="//vkontakte.ru/share.php?url"+t.link)&&(D.href=M),e.link&&(R.value=t.link,V.href=t.link),e.frameWidth&&(q.value=t.frameWidth),e.frameHeight&&(J.value=t.frameHeight),e.link&&te!==(te=t.link+"&edit=1")&&($.href=te),(e.link||e.frameWidth||e.frameHeight)&&oe!==(oe='<iframe src="'+t.link+'" width="'+t.frameWidth+'" height="'+t.frameHeight+'"></iframe>')&&(re.value=oe),(e.frameWidth||e.frameHeight||e.link)&&me!==(me="//www.kosmosnimki.ru/demo/winnie_2.0/iframePreview.html?width="+t.frameWidth+"&height="+t.frameHeight+"&url="+t.link)&&(fe.href=me)},i:function(e,t){ge||this.m(e,t)},o:r,d:function(e){e&&l(n),_e&&_e.d(),p(q,"change",ye),p(J,"change",be)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor)),this._intro=!0}n(oe.prototype,w),n(oe.prototype,se),n(le.prototype,w),le.prototype._recompute=function(e,t){e.conf&&this._differs(t.link,t.link="//www.kosmosnimki.ru/demo/winnie_2.0/?config="+t.conf)&&(e.link=!0)};var ce=window.serverBase||"//maps.kosmosnimki.ru/",de=function(e,t,n,i){return t[e]||(e in n?n[e]:i||!0)};var ue={checkMe:function(e,t){var n=this,i=e.name,s=this.editor.getValue(),r=null;try{r=JSON.parse(s)}catch(e){var o=this.editor.getSession().getAnnotations()[0];alert("Ошибка в конфигурации:\n строка: "+o.row+"\n позиция: "+o.column+"\n сообщение: "+o.text),console.log("error in json: ",o)}if(r)if("refresh"===i)this.set({permalink:r});else if("link"===i){this.get().share?(t.classList.remove("checked"),this.set({share:!1})):(t.classList.add("checked"),fetch(ce+"TinyReference/Create.ashx",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded"},body:L.gmxUtil.getFormData({WrapStyle:"None",content:r}),mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){"ok"===e.Status&&n.set({share:!0,conf:e.Result})}).catch(console.error))}},checkPermalink:function(e){var t=this.get().urlParams;if(e.app&&(e.app.theme=de("theme",t,e.app,"dark"),e.app.iconSidebar=de("iconSidebar",t,e.app),e.app.treeView=de("treeView",t,e.app),e.app.iconLayers=de("iconLayers",t,e.app),e.app.drawing=de("drawing",t,e.app),e.app.gmxTimeline=de("gmxTimeline",t,e.app)),this.set({permalink:e}),t.edit){var n=ace.edit("editor");n.setTheme("ace/theme/monokai"),n.getSession().setMode("ace/mode/json"),n.container.getElementsByClassName("ace_scrollbar-v")[0].style.width="4px",n.setValue(JSON.stringify(e,null,2)),this.editor=n}e.app.gmxTimeline&&"false"!==e.app.gmxTimeline&&(L.gmxUtil.requestLink("//maps.kosmosnimki.ru/api/plugins/timeline/2.9.1/timeline.js"),L.gmxUtil.requestLink("//maps.kosmosnimki.ru/api/plugins/timeline/2.9.1/timeline.css"),L.gmxUtil.requestLink("//maps.kosmosnimki.ru/api/plugins/external/GMXPluginTimeLine/L.Control.gmxTimeLine.js"),L.gmxUtil.requestLink("//maps.kosmosnimki.ru/api/plugins/external/GMXPluginTimeLine/L.Control.gmxTimeLine.css"))},getPermalink:function(e){var t=this,n={};e&&fetch(ce+"TinyReference/Get.ashx?WrapStyle=None&id="+e,{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){"ok"===e.Status&&(n=e.Result?JSON.parse(e.Result):{}),t.checkPermalink(n)})}};function he(e){var t=e.changed,n=e.current;e.previous;if(t.urlParams){var i=n.urlParams.config||"M6QMS";this.getPermalink(i)}}function fe(e){var t=this._svelte,n=t.component,i=t.ctx;n.checkMe(i.it,this)}function pe(e,t,n){var i=Object.create(e);return i.it=t[n],i}function me(e,t){for(var n,i,s,r,h,f,p=t.dropdownMenu,m=[],v=0;v<p.length;v+=1)m[v]=ve(e,pe(t,p,v));return{c:function(){n=d("div"),i=d("div"),s=d("div"),r=d("div");for(var e=0;e<m.length;e+=1)m[e].c();h=u("\n\t\t\t"),f=d("div"),r.className="dropdownMenuWidget svelte-gw2s3e",s.className="sidebarPanel-toolbarContainer svelte-gw2s3e",f.id="editor",f.className="editor svelte-gw2s3e",i.className="sidebarPanel svelte-gw2s3e",n.className="editor-sidebarContainer editor_sidebarExpanded svelte-gw2s3e"},m:function(e,t){a(e,n,t),o(n,i),o(i,s),o(s,r);for(var l=0;l<m.length;l+=1)m[l].m(r,null);o(i,h),o(i,f)},p:function(t,n){if(t.dropdownMenu){p=n.dropdownMenu;for(var i=0;i<p.length;i+=1){var s=pe(n,p,i);m[i]?m[i].p(t,s):(m[i]=ve(e,s),m[i].c(),m[i].m(r,null))}for(;i<m.length;i+=1)m[i].d(1);m.length=p.length}},d:function(e){e&&l(n),c(m,e)}}}function ve(e,t){var n,i,s,r,c,h,m,g=t.it.title;return{c:function(){n=d("div"),i=d("i"),r=u("\n\t\t\t\t\t"),c=d("span"),h=u(g),i.className=s="icon-"+t.it.name+" svelte-gw2s3e",n._svelte={component:e,ctx:t},f(n,"click",fe),n.className=m="dropdownMenuWidget-item"+(t.it.checked?" checked":"")+" svelte-gw2s3e"},m:function(e,t){a(e,n,t),o(n,i),o(n,r),o(n,c),o(c,h)},p:function(e,r){t=r,e.dropdownMenu&&s!==(s="icon-"+t.it.name+" svelte-gw2s3e")&&(i.className=s),e.dropdownMenu&&g!==(g=t.it.title)&&v(h,g),n._svelte.ctx=t,e.dropdownMenu&&m!==(m="dropdownMenuWidget-item"+(t.it.checked?" checked":"")+" svelte-gw2s3e")&&(n.className=m)},d:function(e){e&&l(n),p(n,"click",fe)}}}function ge(e,t){var n,i={conf:t.conf},s=new le({root:e.root,store:e.store,data:i});return{c:function(){s._fragment.c()},m:function(e,t){s._mount(e,t),n=!0},p:function(e,t){var n={};e.conf&&(n.conf=t.conf),s._set(n)},i:function(e,t){n||this.m(e,t)},o:function(e){n&&(s&&s._fragment.o(e),n=!1)},d:function(e){s.destroy(e)}}}function _e(e){var t=this;b(this,e),this._state=n({share:!1,conf:"",urlParams:{},dropdownMenu:[{name:"refresh",title:"Refresh"},{name:"link",title:"Share",checked:!1}],map:null,permalink:null},e.data),this._intro=!!e.intro,this._handlers.state=[he],he.call(this,{changed:i({},this._state),current:this._state}),this._fragment=function(e,t){var n,i,r,o,c,f={},p=t.urlParams.edit&&me(e,t),m={permalink:t.permalink};void 0!==t.map&&(m.map=t.map,f.map=!0);var v=new oe({root:e.root,store:e.store,data:m,_bind:function(t,n){var i={};!f.map&&t.map&&(i.map=n.map),e._set(i),f={}}});e.root._beforecreate.push(function(){v._bind({map:1},v.get())});var g=t.share&&ge(e,t);return{c:function(){p&&p.c(),n=u("\n"),i=d("div"),v._fragment.c(),r=u("\n"),g&&g.c(),o=h(),i.className="editor-viewerContainer editor_sidebarExpanded svelte-gw2s3e"},m:function(e,t){p&&p.m(e,t),a(e,n,t),a(e,i,t),v._mount(i,null),a(e,r,t),g&&g.m(e,t),a(e,o,t),c=!0},p:function(i,s){(t=s).urlParams.edit?p?p.p(i,t):((p=me(e,t)).c(),p.m(n.parentNode,n)):p&&(p.d(1),p=null);var r={};i.permalink&&(r.permalink=t.permalink),!f.map&&i.map&&(r.map=t.map,f.map=void 0!==t.map),v._set(r),f={},t.share?(g?g.p(i,t):(g=ge(e,t))&&g.c(),g.i(o.parentNode,o)):g&&g.o(function(){g.d(1),g=null})},i:function(e,t){c||this.m(e,t)},o:function(e){c&&(e=s(e,2),v&&v._fragment.o(e),g?g.o(e):e(),c=!1)},d:function(e){p&&p.d(e),e&&(l(n),l(i)),v.destroy(),e&&l(r),g&&g.d(e),e&&l(o)}}}(this,this._state),this.root._oncreate.push(function(){t.fire("update",{changed:i({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),y(this)),this._intro=!0}n(_e.prototype,w),n(_e.prototype,ue);var ye,be=(ye={},location.search.substr(1).split("&").forEach(function(e){var t=e.split("=");ye[t[0]]=t[1]}),ye);return new _e({target:document.body,data:{urlParams:be,name:"world"}})}(L);
//# sourceMappingURL=winnie_2.0.js.map
